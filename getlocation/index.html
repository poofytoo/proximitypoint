<DOCTYPE html>
<html>
<head>
  <title></title>
  <meta name = "viewport" content = "user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width">
  <link rel="stylesheet" type="text/css" href="css/reset.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="css/main.css" media="screen" />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="js/scripts.js"></script>
  <script>
  $(document).ready(function() {
    var INTERVAL = 300;


    var x = document.getElementById("demo");
    var xcoord, ycoord;

    var getLocation = function() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else {
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
    }

    function showPosition(position) {
        xcoord = position.coords.latitude;
        ycoord = position.coords.longitude; 

        id = $("input[type='radio']:checked").val();

        if (id != undefined) {
        var html = ''
        html += 'lat: ' + xcoord + '<br />';
        html += 'long: ' + ycoord + '<br />';
        html += 'You are phone: ' + id + '<br />';
        html += '----<br />';
        $('.coords').html(html);

        
        var url = 'http://smallerpackage4me.ru:5000/dump?phone_id=' + id + '&coords=' + xcoord + '|' + ycoord;
        
          $.get(url, function(data) {
            console.log(data);
          });
        }
    }

    $('.interval').text(INTERVAL);
    window.setInterval(getLocation, INTERVAL)
  })

  </script>

</head>
<body>
  <h1><em>ProximityBand</em> v0.1</h1>
  <input id="r1" type="radio" name="phone-id" value="1"><label for="r1">Phone 1</label>
  <input id="r2" type="radio" name="phone-id" value="2"><label for="r2">Phone 2</label><br /><br />

  Getting new location every <span class="interval"></span>ms...<br />
  <div class="coords"></div>

</body>
</html>
